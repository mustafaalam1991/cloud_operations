# üìò Ceph Administration and Monitoring Guide

A practical reference for managing Ceph in CBIS environments. Covers common administrative tasks, cluster performance monitoring, and troubleshooting.

---

## üìö Table of Contents

1. [Getting Started](#getting-started)
2. [Ceph Administration Tasks](#ceph-administration-tasks)
   - [1. Changing Replication Factor](#1-changing-replication-factor)
   - [2. Calculating PG Numbers](#2-calculating-pg-numbers)
   - [3. Modifying PG Values](#3-modifying-pg-values)
   - [4. Pool Details](#4-pool-details)
   - [5. Mapping OSDs to Disks](#5-mapping-osds-to-disks)
   - [6. Restarting an OSD](#6-restarting-an-osd)
   - [7. Admin Sockets (asok)](#7-admin-sockets-asok)
   - [8. Reverting Lost Objects](#8-reverting-lost-objects)
   - [9. Scrubbing PGs](#9-scrubbing-pgs)
   - [10. High Disk Utilization OSDs](#10-high-disk-utilization-osds)
3. [Ceph Monitoring](#ceph-monitoring)
   - [Health](#health)
   - [Cluster Usage](#cluster-usage)
   - [OSD Stats](#osd-stats)
   - [Performance Stats](#performance-stats)
4. [Useful References](#useful-references)

---

## üèÅ Getting Started

To begin learning Ceph administration, start with the [10 Commands Every Ceph Administrator Should Know](https://tracker.ceph.com/projects/ceph/wiki/10_Commands_Every_Ceph_Administrator_Should_Know).

---

## ‚öôÔ∏è Ceph Administration Tasks

### 1. Changing Replication Factor

By default, Ceph pools are set with a replication factor of 3. VNF owners may request a replication factor of 2 to improve I/O performance. Lowering the replication factor reduces redundancy and increases the risk of data loss.

**Steps:**

```bash
# Check current replication settings
sudo ceph osd pool ls detail

# Watch Ceph logs in a new terminal
sudo ceph -w

# Change replication size
sudo ceph osd pool set <pool-name> size 2
```

**Pools of Interest:**

- `volumes`: VMs on SSDs
- `volumes-fast`: VMs on NVMe

---

### 2. Calculating PG Numbers

The number of placement groups (PGs) affects performance. Use the formula:

```
Total PGs = (Number of OSDs √ó 100) √∑ Replication Factor
```

**Examples:**

- 80 OSDs, size 2 ‚Üí 4000 ‚Üí Use 4096 (nearest power of 2)
- 80 OSDs, size 3 ‚Üí 2667 ‚Üí Use 2048

üîó [Placement Group Sizing Guide](https://docs.ceph.com/docs/mimic/rados/operations/placement-groups/)

...

(Truncated here for brevity. The actual code continues with the full content.)

